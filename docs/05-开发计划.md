# 婚纱照选片工具 - 开发计划

## 项目里程碑

```
Week 1: 基础框架搭建
    │
    ├── Day 1-2: 项目初始化和环境配置
    ├── Day 3-4: 基础 UI 组件开发
    └── Day 5-7: 照片导入功能实现

Week 2: 核心功能开发
    │
    ├── Day 1-2: 照片网格和选中功能
    ├── Day 3-4: 分组管理和照片移动
    └── Day 5-7: 动画效果实现

Week 3: 高级功能开发
    │
    ├── Day 1-3: 双图对比模式
    ├── Day 4-5: 缩略图生成和缓存
    └── Day 6-7: 导出功能

Week 4: 优化和测试
    │
    ├── Day 1-3: 性能优化
    ├── Day 4-5: 测试和 Bug 修复
    └── Day 6-7: 文档完善和发布准备
```

---

## Phase 1: 基础框架 (Week 1)

### Day 1-2: 项目初始化

#### 任务清单
- [ ] 初始化 Tauri + React + TypeScript 项目
- [ ] 配置 Tailwind CSS
- [ ] 配置 ESLint + Prettier
- [ ] 配置 Git 提交规范 (Husky)
- [ ] 创建基础目录结构
- [ ] 编写项目 README

#### 技术要点
```bash
# 创建 Tauri 项目
npm create tauri-app@latest photo-picker-pro

# 选择: React + TypeScript + Vite

# 安装依赖
npm install zustand framer-motion react-window clsx tailwind-merge
npm install -D @types/react-window
```

#### 验收标准
- [ ] 项目可以正常启动 (`npm run tauri dev`)
- [ ] 热更新正常工作
- [ ] 代码格式化配置生效

---

### Day 3-4: 基础 UI 组件

#### 任务清单
- [ ] 创建全局样式变量 (颜色、间距)
- [ ] 开发 Layout 组件 (Header, Sidebar, MainContent, StatusBar)
- [ ] 开发通用组件 (Button, IconButton, Modal, Tooltip)
- [ ] 配置深色主题
- [ ] 实现响应式布局基础

#### 组件清单
| 组件 | 路径 | 说明 |
|------|------|------|
| Header | `components/layout/Header.tsx` | 顶部工具栏 |
| Sidebar | `components/layout/Sidebar.tsx` | 右侧分组面板 |
| MainContent | `components/layout/MainContent.tsx` | 主内容区 |
| StatusBar | `components/layout/StatusBar.tsx` | 底部状态栏 |
| Button | `components/common/Button.tsx` | 按钮组件 |
| IconButton | `components/common/IconButton.tsx` | 图标按钮 |
| Modal | `components/common/Modal.tsx` | 模态框 |
| Tooltip | `components/common/Tooltip.tsx` | 提示框 |

#### 验收标准
- [ ] 所有组件可以正常渲染
- [ ] 主题切换正常工作
- [ ] 布局在不同窗口大小下正常

---

### Day 5-7: 照片导入功能

#### 任务清单
- [ ] 实现文件夹扫描 (Rust)
- [ ] 实现拖拽导入区域 (React)
- [ ] 实现文件选择对话框导入
- [ ] 实现导入进度显示
- [ ] 过滤非图片文件
- [ ] 基础照片数据结构定义

#### Rust 命令
```rust
// 需要实现的命令
#[command]
async fn scan_directory(path: String) -> Result<Vec<PhotoInfo>, String>;

#[command]
async fn get_supported_formats() -> Vec<String>;
```

#### 数据结构
```typescript
interface PhotoInfo {
  id: string;
  name: string;
  path: string;
  size: number;
  createdAt: Date;
  modifiedAt: Date;
  format: string;
}
```

#### 验收标准
- [ ] 可以拖拽文件夹导入
- [ ] 可以点击选择文件夹导入
- [ ] 导入过程显示进度
- [ ] 只导入支持的图片格式
- [ ] 导入完成后照片显示在网格中

---

## Phase 2: 核心功能 (Week 2)

### Day 1-2: 照片网格和选中

#### 任务清单
- [ ] 开发 PhotoCard 组件
- [ ] 开发 PhotoGrid 组件
- [ ] 实现照片选中/取消功能
- [ ] 实现多选功能 (Ctrl/Cmd + 点击)
- [ ] 实现全选功能 (Ctrl/Cmd + A)
- [ ] 实现照片信息展示

#### 组件清单
| 组件 | 路径 | 说明 |
|------|------|------|
| PhotoCard | `components/photo/PhotoCard.tsx` | 单张照片卡片 |
| PhotoGrid | `components/photo/PhotoGrid.tsx` | 照片网格容器 |
| PhotoInfo | `components/photo/PhotoInfo.tsx` | 照片信息展示 |

#### 状态管理
```typescript
// stores/photoStore.ts
interface PhotoState {
  photos: Map<string, Photo>;
  selectedIds: Set<string>;
  selectPhoto: (id: string, multi?: boolean) => void;
  clearSelection: () => void;
  selectAll: () => void;
}
```

#### 验收标准
- [ ] 照片以网格形式展示
- [ ] 点击照片可以选中/取消
- [ ] 按住 Ctrl 可以多选
- [ ] 选中的照片有视觉反馈
- [ ] 显示照片名称和大小

---

### Day 3-4: 分组管理

#### 任务清单
- [ ] 定义分组数据结构
- [ ] 开发 GroupTabs 组件
- [ ] 实现分组切换功能
- [ ] 实现照片移动功能
- [ ] 开发 GroupPanel 组件
- [ ] 实现分组统计

#### 数据结构
```typescript
interface Group {
  id: string;
  name: string;
  type: 'default' | 'keep' | 'reject';
  icon: string;
  color?: string;
}

interface Photo {
  id: string;
  name: string;
  path: string;
  groupId: string;
  thumbnailUrl?: string;
  status: 'pending' | 'selected';
}
```

#### 组件清单
| 组件 | 路径 | 说明 |
|------|------|------|
| GroupTabs | `components/group/GroupTabs.tsx` | 分组标签栏 |
| GroupPanel | `components/group/GroupPanel.tsx` | 分组内容面板 |
| GroupBadge | `components/group/GroupBadge.tsx` | 分组数量徽章 |

#### 验收标准
- [ ] 显示三个默认分组 (默认/保留/不选)
- [ ] 点击分组标签切换显示
- [ ] 分组显示照片数量
- [ ] 照片可以移动到不同分组

---

### Day 5-7: 动画效果

#### 任务清单
- [ ] 配置 Framer Motion
- [ ] 实现照片选中动画
- [ ] 实现照片移动动画
- [ ] 实现分组切换动画
- [ ] 实现照片导入动画
- [ ] 实现删除动画

#### 动画规范
| 动画 | 时长 | 缓动函数 |
|------|------|----------|
| 选中 | 200ms | ease-out |
| 移动 | 400ms | cubic-bezier(0.4, 0, 0.2, 1) |
| 删除 | 300ms | ease-in |
| 导入 | 150ms | ease-out |
| 切换 | 250ms | ease-in-out |

#### 验收标准
- [ ] 选中照片有缩放动画
- [ ] 移动照片有飞入动画
- [ ] 删除照片有淡出动画
- [ ] 切换分组有过渡动画
- [ ] 动画流畅不卡顿

---

## Phase 3: 高级功能 (Week 3)

### Day 1-3: 双图对比模式

#### 任务清单
- [ ] 开发 CompareView 组件
- [ ] 实现左右分屏布局
- [ ] 实现照片选择器
- [ ] 实现跨分组选择
- [ ] 实现图片缩放和拖拽
- [ ] 实现同步缩放功能
- [ ] 实现对比决策功能

#### 组件清单
| 组件 | 路径 | 说明 |
|------|------|------|
| CompareView | `components/compare/CompareView.tsx` | 对比视图容器 |
| ComparePanel | `components/compare/ComparePanel.tsx` | 单张对比面板 |
| CompareSelector | `components/compare/CompareSelector.tsx` | 照片选择器 |
| SyncControls | `components/compare/SyncControls.tsx` | 同步控制 |

#### 状态管理
```typescript
// stores/compareStore.ts
interface CompareState {
  isComparing: boolean;
  leftPhotoId: string | null;
  rightPhotoId: string | null;
  leftGroupId: string;
  rightGroupId: string;
  syncZoom: boolean;
  startCompare: (leftId: string, rightId: string) => void;
  endCompare: () => void;
}
```

#### 验收标准
- [ ] 可以进入对比模式
- [ ] 可以选择左右两侧照片
- [ ] 支持跨分组选择
- [ ] 图片可以缩放和拖拽
- [ ] 可以同步两侧缩放
- [ ] 可以在对比界面做决策

---

### Day 4-5: 缩略图生成

#### 任务清单
- [ ] 实现缩略图生成 (Rust)
- [ ] 实现缩略图缓存
- [ ] 实现懒加载
- [ ] 优化大图片处理
- [ ] 实现缩略图预生成

#### Rust 命令
```rust
#[command]
async fn generate_thumbnail(path: String, size: u32) -> Result<String, String>;

#[command]
async fn batch_generate_thumbnails(paths: Vec<String>) -> Result<Progress, String>;
```

#### 验收标准
- [ ] 自动生成照片缩略图
- [ ] 缩略图缓存到本地
- [ ] 视口外照片不加载
- [ ] 缩略图加载速度快

---

### Day 6-7: 导出功能

#### 任务清单
- [ ] 实现导出对话框
- [ ] 实现生成选片报告
- [ ] 实现复制照片到文件夹
- [ ] 实现导出进度显示
- [ ] 实现导出历史记录

#### Rust 命令
```rust
#[command]
async fn export_photos(photo_ids: Vec<String>, target_path: String) -> Result<(), String>;

#[command]
async fn generate_report(group_id: String) -> Result<Report, String>;
```

#### 验收标准
- [ ] 可以导出选片报告
- [ ] 可以复制照片到指定文件夹
- [ ] 导出过程显示进度
- [ ] 导出完成后有提示

---

## Phase 4: 优化和测试 (Week 4)

### Day 1-3: 性能优化

#### 任务清单
- [ ] 实现虚拟列表 (react-window)
- [ ] 优化照片渲染性能
- [ ] 优化状态更新性能
- [ ] 实现图片懒加载
- [ ] 优化内存占用
- [ ] 添加性能监控

#### 优化目标
| 指标 | 目标 |
|------|------|
| 首屏加载 | < 2s |
| 照片切换 | < 100ms |
| 内存占用 | < 500MB (500张照片) |
| 帧率 | 60fps |

#### 验收标准
- [ ] 500张照片流畅浏览
- [ ] 内存占用在合理范围
- [ ] 动画保持 60fps

---

### Day 4-5: 测试和 Bug 修复

#### 任务清单
- [ ] 编写单元测试
- [ ] 编写集成测试
- [ ] 进行手动测试
- [ ] 修复发现的 Bug
- [ ] 进行边界情况测试
- [ ] 进行性能测试

#### 测试范围
| 模块 | 测试内容 |
|------|----------|
| 导入 | 各种格式、大文件夹、取消导入 |
| 网格 | 大量照片、快速切换、选中操作 |
| 分组 | 移动照片、切换分组、统计准确 |
| 对比 | 选择照片、缩放同步、决策操作 |
| 导出 | 各种路径、大量照片、中断处理 |

#### 验收标准
- [ ] 核心功能测试覆盖 > 80%
- [ ] 无严重 Bug
- [ ] 边界情况处理完善

---

### Day 6-7: 文档和发布

#### 任务清单
- [ ] 完善用户文档
- [ ] 完善开发文档
- [ ] 编写更新日志
- [ ] 配置自动更新
- [ ] 准备发布包
- [ ] 编写发布说明

#### 发布检查清单
- [ ] Windows 安装包测试
- [ ] macOS 安装包测试
- [ ] 代码签名配置
- [ ] 自动更新配置
- [ ] 崩溃报告配置

---

## 风险和对策

| 风险 | 可能性 | 影响 | 对策 |
|------|--------|------|------|
| Tauri 2.x 稳定性 | 中 | 高 | 关注官方更新，准备降级方案 |
| 大图片处理性能 | 中 | 高 | 提前进行性能测试，优化缩略图策略 |
| 动画性能问题 | 低 | 中 | 使用 Framer Motion 优化，必要时降级 |
| 跨平台兼容性 | 中 | 中 | 早期在双平台测试，及时发现问题 |

---

## 开发规范

### 每日站会
- 时间: 每天上午 10:00
- 时长: 15分钟
- 内容: 昨日完成、今日计划、遇到的问题

### 代码审查
- 所有代码需通过 PR 合并
- 至少 1 人审查通过
- 自动化检查通过 (CI/CD)

### 提交规范
```
<type>(<scope>): <subject>

type: feat|fix|docs|style|refactor|perf|test|chore
scope: photo|group|compare|import|export|ui|core
```

---

**文档版本**: v1.0
**创建日期**: 2026-01-28
**最后更新**: 2026-01-28
